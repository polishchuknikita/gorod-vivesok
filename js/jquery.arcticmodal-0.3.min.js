var l,o,i,d,s,f,u;l=jQuery,o={type:"html",content:"",url:"",ajax:{},ajax_request:null,closeOnEsc:!0,closeOnOverlayClick:!0,clone:!1,overlay:{block:void 0,tpl:'<div class="arcticmodal-overlay"></div>',css:{backgroundColor:"#000",opacity:.6}},container:{block:void 0,tpl:'<div class="arcticmodal-container"><table class="arcticmodal-container_i"><tr><td class="arcticmodal-container_i2"></td></tr></table></div>'},wrap:void 0,body:void 0,errors:{tpl:'<div class="arcticmodal-error arcticmodal-close"></div>',autoclose_delay:2e3,ajax_unsuccessful_load:"Error"},openEffect:{type:"fade",speed:400},closeEffect:{type:"fade",speed:400},beforeOpen:l.noop,afterOpen:l.noop,beforeClose:l.noop,afterClose:l.noop,afterLoading:l.noop,afterLoadingOnShow:l.noop,errorLoading:l.noop},i=0,d=l([]),s=function(e,a){var o=!0;return l(e).each(function(){l(a.target).get(0)==l(this).get(0)&&(o=!1),0==l(a.target).closest("HTML",l(this).get(0)).length&&(o=!1)}),o},f={getParentEl:function(e){var a=l(e);return a.data("arcticmodal")?a:!!(a=l(e).closest(".arcticmodal-container").data("arcticmodalParentEl"))&&a},transition:function(e,a,o,r){switch(r=null==r?l.noop:r,o.type){case"fade":"show"==a?e.fadeIn(o.speed,r):e.fadeOut(o.speed,r);break;case"none":"show"==a?e.show():e.hide(),r()}},prepare_body:function(e,a){l(".arcticmodal-close",e.body).unbind("click.arcticmodal").bind("click.arcticmodal",function(){return a.arcticmodal("close"),!1})},init_el:function(a,e){var o=a.data("arcticmodal");if(!o){if(i++,(o=e).modalID=i,o.overlay.block=l(o.overlay.tpl),o.overlay.block.css(o.overlay.css),o.container.block=l(o.container.tpl),o.body=l(".arcticmodal-container_i2",o.container.block),e.clone?o.body.html(a.clone(!0)):(a.before('<div id="arcticmodalReserve'+o.modalID+'" style="display: none" />'),o.body.html(a)),f.prepare_body(o,a),o.closeOnOverlayClick&&o.overlay.block.add(o.container.block).click(function(e){s(l(">*",o.body),e)&&a.arcticmodal("close")}),o.container.block.data("arcticmodalParentEl",a),a.data("arcticmodal",o),d=l.merge(d,a),l.proxy(u.show,a)(),"html"==o.type)return a;if(null!=o.ajax.beforeSend){var r=o.ajax.beforeSend;delete o.ajax.beforeSend}if(null!=o.ajax.success){var t=o.ajax.success;delete o.ajax.success}if(null!=o.ajax.error){var c=o.ajax.error;delete o.ajax.error}var n=l.extend(!0,{url:o.url,beforeSend:function(){null==r?o.body.html('<div class="arcticmodal-loading" />'):r(o,a)},success:function(e){a.trigger("afterLoading"),o.afterLoading(o,a,e),null==t?o.body.html(e):t(o,a,e),f.prepare_body(o,a),a.trigger("afterLoadingOnShow"),o.afterLoadingOnShow(o,a,e)},error:function(){a.trigger("errorLoading"),o.errorLoading(o,a),null==c?(o.body.html(o.errors.tpl),l(".arcticmodal-error",o.body).html(o.errors.ajax_unsuccessful_load),l(".arcticmodal-close",o.body).click(function(){return a.arcticmodal("close"),!1}),o.errors.autoclose_delay&&setTimeout(function(){a.arcticmodal("close")},o.errors.autoclose_delay)):c(o,a)}},o.ajax);o.ajax_request=l.ajax(n),a.data("arcticmodal",o)}},init:function(e){if(e=l.extend(!0,{},o,e),!l.isFunction(this))return this.each(function(){f.init_el(l(this),l.extend(!0,{},e))});if(null==e)l.error("jquery.arcticmodal: Uncorrect parameters");else if(""==e.type)l.error('jquery.arcticmodal: Don\'t set parameter "type"');else switch(e.type){case"html":if(""==e.content){l.error('jquery.arcticmodal: Don\'t set parameter "content"');break}var a=e.content;return e.content="",f.init_el(l(a),e);case"ajax":if(""!=e.url)return f.init_el(l("<div />"),e);l.error('jquery.arcticmodal: Don\'t set parameter "url"')}}},u={show:function(){var e=f.getParentEl(this);if(!1!==e){var a=e.data("arcticmodal");if(a.overlay.block.hide(),a.container.block.hide(),l("BODY").append(a.overlay.block),l("BODY").append(a.container.block),a.beforeOpen(a,e),e.trigger("beforeOpen"),"hidden"!=a.wrap.css("overflow")){a.wrap.data("arcticmodalOverflow",a.wrap.css("overflow"));var o=a.wrap.outerWidth(!0);a.wrap.css("overflow","hidden");var r=a.wrap.outerWidth(!0);r!=o&&a.wrap.css("marginRight",r-o+"px")}return d.not(e).each(function(){l(this).data("arcticmodal").overlay.block.hide()}),f.transition(a.overlay.block,"show",1<d.length?{type:"none"}:a.openEffect),f.transition(a.container.block,"show",1<d.length?{type:"none"}:a.openEffect,function(){a.afterOpen(a,e),e.trigger("afterOpen")}),e}l.error("jquery.arcticmodal: Uncorrect call")},close:function(){if(!l.isFunction(this))return this.each(function(){var e=f.getParentEl(this);if(!1===e)l.error("jquery.arcticmodal: Uncorrect call");else{var a=e.data("arcticmodal");!1!==a.beforeClose(a,e)&&(e.trigger("beforeClose"),d.not(e).last().each(function(){l(this).data("arcticmodal").overlay.block.show()}),f.transition(a.overlay.block,"hide",1<d.length?{type:"none"}:a.closeEffect),f.transition(a.container.block,"hide",1<d.length?{type:"none"}:a.closeEffect,function(){a.afterClose(a,e),e.trigger("afterClose"),a.clone||l("#arcticmodalReserve"+a.modalID).replaceWith(a.body.find(">*")),a.overlay.block.remove(),a.container.block.remove(),e.data("arcticmodal",null),l(".arcticmodal-container").length||(a.wrap.data("arcticmodalOverflow")&&a.wrap.css("overflow",a.wrap.data("arcticmodalOverflow")),a.wrap.css("marginRight",0))}),"ajax"==a.type&&a.ajax_request.abort(),d=d.not(e))}});d.each(function(){l(this).arcticmodal("close")})},setDefault:function(e){l.extend(!0,o,e)}},l(function(){o.wrap=l(document.all&&!document.querySelector?"html":"body")}),l(document).bind("keyup.arcticmodal",function(e){var a=d.last();a.length&&a.data("arcticmodal").closeOnEsc&&27===e.keyCode&&a.arcticmodal("close")}),l.arcticmodal=l.fn.arcticmodal=function(e){return u[e]?u[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void l.error("jquery.arcticmodal: Method "+e+" does not exist"):f.init.apply(this,arguments)};